# Ticket Contract Template
#
# This template is schema-aligned with ModelTicketContract and can be copy/pasted
# to create a new ticket contract. Replace all placeholder values with actual data.
#
# Schema Version: 1.0.0
# Model: ModelTicketContract
#
# Usage:
#   1. Copy this template to contracts/<ticket_id>.yaml (e.g., contracts/OMN-962.yaml)
#   2. Replace all placeholder values (marked with <...>)
#   3. Ensure all required fields are filled
#   4. Validate against schema using: poetry run pytest tests/test_yaml_parsing.py -k ticket_contract
#
# For detailed field documentation and examples, see: docs/TEMPLATE_GUIDE.md

schema_version: "1.0.0"
ticket_id: "OMN-000"  # Ticket identifier (e.g., "OMN-962")
summary: "<one-line summary>"

# Seam Ticket: If true, this ticket touches cross-repo interfaces and must be drift-controlled.
# Set to true if the ticket affects interfaces between repositories (events, topics, protocols, etc.)
is_seam_ticket: false

# Interface Change: If true, this ticket changes interface surfaces.
# If false, interfaces_touched must be explicitly empty ([]).
# If true, interfaces_touched should list all affected interface surfaces.
interface_change: false

# Interfaces Touched: List of interface surfaces affected by this ticket.
# Valid values: "events" | "topics" | "protocols" | "envelopes" | "public_api"
# Rules: If interface_change=false, must be empty []. If interface_change=true, list all affected surfaces.
# See docs/TEMPLATE_GUIDE.md for unknown handling and is_complete behavior
interfaces_touched: []

# Evidence Requirements: What proof is required for this ticket to be considered complete.
# If no evidence requirements, use empty list: []
# Valid kinds: "tests" | "docs" | "ci" | "benchmark" | "manual"
# See docs/TEMPLATE_GUIDE.md for detailed guidance and examples
evidence_requirements:
  - kind: "tests"  # Valid values: "tests" | "docs" | "ci" | "benchmark" | "manual"
    description: "<what evidence must exist>"
    command: "<how to reproduce, if applicable>"  # Optional: null or omit if not applicable

# Emergency Bypass: Allows temporary bypass of drift control enforcement.
# WARNING: Use only in genuine emergencies (production incidents, critical blockers).
# See docs/TEMPLATE_GUIDE.md for detailed guidance, warnings, and examples
emergency_bypass:
  enabled: false  # Set to true only in genuine emergencies
  justification: ""  # Required if enabled=true: explain why bypass is necessary
  follow_up_ticket_id: ""  # Required if enabled=true: ticket that will properly address this

# Optional: Declare a golden path event chain test (omit if not a node-based ticket).
# When present, declares an input-to-output contract test for the node pipeline.
# The runner publishes the input fixture to the input topic, waits for a matching
# output event on the output topic, and evaluates all assertions.
#
# golden_path:
#   timeout_ms: 30000   # Single source of truth for round-trip timeout (default: 30000ms)
#   infra: real         # "real" uses live Kafka, "mock" uses an in-process stub
#   input:
#     topic: onex.cmd.{service}.{event}.v1
#     fixture: tests/fixtures/golden/{name}.json
#     input_correlation_id_field: correlation_id  # Optional, default: correlation_id
#   output:
#     topic: onex.evt.{service}.{event}.v1
#     output_correlation_id_field: correlation_id  # Optional, default: correlation_id
#     schema_name: ModelFoo        # Optional; validates output if importable, skips if not
#     assertions:
#       - field: status
#         op: eq
#         value: completed
#       - field: data.count
#         op: gte
#         value: 1
#   test_file: tests/golden/test_{ticket_id_snake}_golden.py  # Optional
