# Ticket Contract Template
#
# This template is schema-aligned with ModelTicketContract and can be copy/pasted
# to create a new ticket contract. Replace all placeholder values with actual data.
#
# Schema Version: 1.0.0
# Model: ModelTicketContract
#
# Usage:
#   1. Copy this template to contracts/<ticket_id>.yaml (e.g., contracts/OMN-962.yaml)
#   2. Replace all placeholder values (marked with <...>)
#   3. Ensure all required fields are filled
#   4. Validate against schema using: poetry run python scripts/validate_yaml_against_schema.py

schema_version: "1.0.0"
ticket_id: "OMN-000"  # Ticket identifier (e.g., "OMN-962")
summary: "<one-line summary>"

# Seam Ticket: If true, this ticket touches cross-repo interfaces and must be drift-controlled.
# Set to true if the ticket affects interfaces between repositories (events, topics, protocols, etc.)
is_seam_ticket: false

# Interface Change: If true, this ticket changes interface surfaces.
# If false, interfaces_touched must be explicitly empty ([]).
# If true, interfaces_touched should list all affected interface surfaces.
interface_change: false

# Interfaces Touched: List of interface surfaces affected by this ticket.
# Valid values: "events" | "topics" | "protocols" | "envelopes" | "public_api"
#
# Rules:
#   - If interface_change=false, this must be empty: []
#   - If interface_change=true, this should list all affected surfaces
#   - Unknown handling: If unsure which interfaces are affected, set interface_change=true
#     and leave this empty temporarily. NOTE: The contract.is_complete property will
#     return False until interfaces_touched is populated. Populate before ticket completion.
interfaces_touched: []

# Evidence Requirements: What proof is required for this ticket to be considered complete.
# If no evidence requirements, use empty list: []
#
# Evidence Kinds (valid values for 'kind'):
#   - "tests": Automated test coverage (unit, integration, property-based)
#   - "docs": Documentation updates (ADRs, guides, API docs)
#   - "ci": CI/CD pipeline changes (new checks, validation gates)
#   - "benchmark": Performance benchmarks (latency, throughput, memory)
#   - "manual": Manual verification steps (testing checklist, manual QA)
#
# Unknown handling: If evidence requirements are not yet known, leave empty
#   but document in ticket description that requirements will be added
evidence_requirements:
  - kind: "tests"  # Valid values: "tests" | "docs" | "ci" | "benchmark" | "manual"
    description: "<what evidence must exist>"
    command: "<how to reproduce, if applicable>"  # Optional: null or omit if not applicable
  # Example with command:
  # - kind: "tests"
  #   description: "Unit tests for ModelDayClose date validation"
  #   command: "poetry run pytest tests/test_models.py::test_day_close_date_validation"
  #
  # Example without command (docs don't need reproduction commands):
  # - kind: "docs"
  #   description: "Update ADR for ticket contract schema"
  #   command: null  # or simply omit this field

# Emergency Bypass: Allows temporary bypass of drift control enforcement.
#
# WARNING: Use only in genuine emergencies (production incidents, critical blockers).
# If enabled, you MUST provide:
#   1. justification: Clear reason why bypass is necessary
#   2. follow_up_ticket_id: Ticket ID that will address the bypass properly
#
# Unknown handling: If you're unsure whether bypass is needed, set enabled=false
#   and document the situation in the ticket description for review
emergency_bypass:
  enabled: false  # Set to true only in genuine emergencies
  justification: ""  # Required if enabled=true: explain why bypass is necessary
  follow_up_ticket_id: ""  # Required if enabled=true: ticket that will properly address this

# Example of emergency bypass (DO NOT USE unless genuine emergency):
# emergency_bypass:
#   enabled: true
#   justification: "Production incident requires immediate hotfix. Full contract will be created in follow-up ticket."
#   follow_up_ticket_id: "OMN-999"
