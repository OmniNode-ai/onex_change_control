# Day Close Report Template
#
# This template is schema-aligned with ModelDayClose and can be copy/pasted
# to create a new day close report. Replace all placeholder values with actual data.
#
# Schema Version: 1.0.0
# Model: ModelDayClose
#
# Usage:
#   1. Copy this template to drift/day_close/YYYY-MM-DD.yaml
#   2. Replace all placeholder values (marked with <...> or YYYY-MM-DD)
#   3. Ensure all required fields are filled
#   4. Validate against schema using: poetry run python scripts/validate_yaml_against_schema.py

schema_version: "1.0.0"
date: "YYYY-MM-DD"  # ISO date format (e.g., "2025-12-21")

# Goal: deterministic daily reconciliation of plan vs actual work across repos.
# Rule: every actual item must map to a plan item OR be recorded as drift_detected.

# Daily process evolution (keep agility reviewable + rollbackable)
# If no process changes today, use empty list: []
process_changes_today:
  - change: "<what changed in the process today>"
    rationale: "<why we changed it>"
    replaces: "<what it replaces / previous behavior>"

# Planned requirements for today
# If no plan items, use empty list: []
plan:
  - requirement_id: "MVP-2WAY-REGISTRATION"
    summary: "2-way registration workflow done on real infra (Redpanda + Consul + Postgres)"

# Actual work completed by repository
# If no actual work, use empty list: []
actual_by_repo:
  - repo: "OmniNode-ai/omnibase_core"
    prs:
      - pr: 1  # PR number (must be >= 1)
        title: "<PR title>"
        state: "merged"  # Valid values: "merged" | "open"
        notes: "<why it matters / what it unblocks>"
  - repo: "OmniNode-ai/omnibase_infra"
    prs: []  # Empty list if no PRs for this repo

# Drift detected: work that happened but wasn't in plan
# If no drift detected, use empty list: []
# Unknown handling: If you're unsure about drift, record it here with category
#   and mark correction_for_tomorrow as "TBD - requires investigation"
drift_detected:
  - drift_id: "DRIFT-001"  # Unique identifier (e.g., "DRIFT-001", "DRIFT-002")
    category: "scope"  # Valid values: "scope" | "architecture" | "interfaces" | "dependencies" | "infra" | "process"
    evidence: "<what changed / where (PRs, commits, files)>"
    impact: "<why it matters>"
    correction_for_tomorrow: "<specific fix / decision / ticket>"

# Invariants checked: ONEX architectural invariants
# Unknown handling: Use "unknown" if invariant status cannot be determined
#   (e.g., tests not run yet, investigation pending)
# Valid values for each field: "pass" | "fail" | "unknown"
invariants_checked:
  reducers_pure: "pass"  # Reducers are pure (no I/O)
  orchestrators_no_io: "pass"  # Orchestrators perform no I/O
  effects_do_io_only: "pass"  # Effects perform I/O only
  real_infra_proof_progressing: "pass"  # Real infrastructure proof is progressing

# Actionable corrections for tomorrow
# If no corrections, use empty list: []
corrections_for_tomorrow:
  - "<actionable correction>"

# Risks identified today
# If no risks, use empty list: []
risks:
  - risk: "<short risk description>"
    mitigation: "<short mitigation description>"
